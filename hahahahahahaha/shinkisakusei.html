<!doctype html>


<!-- 成否メッセージ（GETクエリで簡易表示） -->
<div class="alerts" id="alerts"></div>


<form id="signupForm" action="signup_process.php" method="post" novalidate>
<input type="hidden" name="token" id="csrfToken" value="">


<div class="field">
<label for="name" class="label">名前</label>
<input id="name" name="name" type="text" placeholder="お名前を入力してください" required>
</div>


<div class="field">
<label for="email" class="label">メールアドレス</label>
<input id="email" name="email" type="email" placeholder="メールアドレスを入力してください" required>
</div>


<div class="field">
<label for="password" class="label">パスワード</label>
<input id="password" name="password" type="password" placeholder="パスワードを入力してください" minlength="6" required>
</div>


<button type="submit" class="submit">新規作成</button>
</form>


<div class="bubbles" aria-hidden="true"></div>
</main>


<script>
// 1) CSRFトークンを取得して hidden にセット
fetch('csrf.php', {credentials: 'same-origin'})
.then(r => r.json())
.then(data => { document.getElementById('csrfToken').value = data.token || ''; })
.catch(() => { /* 失敗しても送信は可能だが、サーバで弾かれる */ });


// 2) ?ok=1 や ?error=... をメッセージ表示（簡易）
const params = new URLSearchParams(location.search);
const alerts = document.getElementById('alerts');
if (params.get('ok') === '1') {
alerts.innerHTML = '<div class="ok" style="background:#ecfeff;border:1px solid #6ee7f9;color:#0e7490;padding:8px 12px;border-radius:10px;">登録が完了しました！</div>';
} else if (params.get('error')) {
const msg = decodeURIComponent(params.get('error'));
alerts.innerHTML = '<div class="error" style="background:#ffe6e6;border:1px solid #ff9ca1;color:#9b1c1c;padding:8px 12px;border-radius:10px;"></div>';
alerts.querySelector('.error').textContent = msg;
}
</script>
</body>
</html>